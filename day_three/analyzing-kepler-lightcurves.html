
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Exploring Confirmed Planets &#8212; Exoplanets</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Radial Velocities and Atmospheres" href="../day_four/radial-velocities-and-atmospheres.html" />
    <link rel="prev" title="Defining a Model" href="../day_two/defining-a-model.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Exoplanets</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Exploring Distance Worlds: Understanding Exoplanets
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Day 1
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../day_one/introduction-to-exoplanets.html">
   Introduction to Exoplanets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../day_one/exoplanet-transits.html">
   Exoplanet Transits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../day_one/analyzing-light-curves.html">
   Analyzing Light Curves
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../day_one/generating-fake-data.html">
   Generating Fake Data
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Day 2
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../day_two/analyzing-published-data.html">
   Analyzing Published Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../day_two/making-our-own-data.html">
   Making Our Own Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../day_two/defining-a-model.html">
   Defining a Model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Day 3
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Exploring Confirmed Planets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Day 4
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../day_four/radial-velocities-and-atmospheres.html">
   Radial Velocities and Atmospheres
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/intro_to_colab_notebooks.html">
   Introduction to Colab
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/nmearl/wsp-exoplanets/main?urlpath=tree/docs/day_three/analyzing-kepler-lightcurves.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/nmearl/wsp-exoplanets"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/nmearl/wsp-exoplanets/issues/new?title=Issue%20on%20page%20%2Fday_three/analyzing-kepler-lightcurves.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/day_three/analyzing-kepler-lightcurves.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/day_three/analyzing-kepler-lightcurves.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-on-your-own">
   Plotting on your own
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Exploring Confirmed Planets</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-on-your-own">
   Plotting on your own
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="exploring-confirmed-planets">
<h1>Exploring Confirmed Planets<a class="headerlink" href="#exploring-confirmed-planets" title="Permalink to this headline">#</a></h1>
<p>Now that you have an understanding of stellar light curves and what we can learn from them, let’s explore some archived Kepler data for confirmed planets. To start, visit <a class="reference external" href="https://exoplanetarchive.ipac.caltech.edu/cgi-bin/TblView/nph-tblView?app=ExoTbls&amp;config=PS">this following link</a>.</p>
<p>This will bring you to the search page for the database of confirmed planets. We are going to set some parameters in order to limit our search to large, short period planets with deep transit depths (which, as you discovered earlier, are the easiest planets to detect with this method). In order to do so, take the following steps:</p>
<ol class="simple">
<li><p>In the column titled “Planet Radius [Jupiter radii]”, type in  &gt; 0.8. Note that this is in units of Jupiter radii. This value will ensure that the depth of our transit signal is deep and easy to detect.</p></li>
<li><p>In the column titled “Orbital Period [days]”, let’s make it less than 20, say. For this, you have to type &lt; 20. This will make it more likely that you’ll see multiple transits during your observation.</p></li>
<li><p>Let’s just look at planets that have been observed by Kepler, so in the “Host Name” column, write “kepler”. This way, we can go and readily look at the Kepler light curves which have all been made public.</p></li>
<li><p>As an example, let’s choose Kepler 435. To find it easily, click on the down arrow button in the “Planet Radius” column to sort by decreasing radii. (You’ll later choose your own planet to present on, so make sure to refer back to these instructions.)</p></li>
<li><p>Clicking on the name will bring you to a page with more detailed information on your planet. Among this information, you’ll find  estimates quoted from the literature for various parameters, and even some images in the top right of what that region of sky looks like in different wavebands (you may want to include these images in your presentation for whichever planet you choose).</p></li>
<li><p>Note at the top of the page, under the heading “Object and Aliases”, there will be some information on what name that system is cross-listed as in a few different telescopes and catalogs. (Write down these names!) Find the number that follows the letters “KIC”. In our case, this is “KIC 7529266  b”. Copy this number, and paste it into the “Kepler ID” field in <a class="reference external" href="https://exoplanetarchive.ipac.caltech.edu/">this following link</a>, and hit enter.</p>
<ul class="simple">
<li><p>Important: when picking a planet on your own, if it does not have a KIC ID number listed in “Object and Aliases”, go back and choose a different planet until you find one that does.</p></li>
</ul>
</li>
<li><p>Choose, say, the last row in the table that comes up, and click on the “DV Time Series” link. This will take you to a page where it plots for you a light curve of your star, and the observed transiting planet signature. You can zoom in on the light curve by clicking and dragging to form a rectangle that encompasses the data you want to zoom in on, or by clicking the magnifying glass at the bottom.</p></li>
<li><p>By default, it will plot for you in the x-axis column “TIME”, and in the y-axis column it plots “LC_INIT”. In other words, you are seeing time on the x-axis and on the y-axis you are seeing the initial, <em>raw</em> light curve. Play around with the other possible columns for your x and y inputs.</p>
<ul class="simple">
<li><p>For example, discuss what “LC_DETREND” means, and why it looks better than “LC_INIT”.</p></li>
<li><p>Try plotting “PHASE [days]” on the x-axis. What does this do?</p></li>
</ul>
</li>
<li><p>Once you are happy with how it looks, download a PNG of the light curve using the second-from-the-right icon at the bottom. Note that you can save multiple snapshots like this, for instance, if you want a zoomed-in and zoomed-out view, or if you want to plot a phase graph and a time graph.</p></li>
</ol>
<p>Congratulations; you’ve just characterized a real planet!  You’ve now joined hundreds of astronomers around the world who use Kepler data to further our understanding of exoplanets.</p>
<section id="plotting-on-your-own">
<h2>Plotting on your own<a class="headerlink" href="#plotting-on-your-own" title="Permalink to this headline">#</a></h2>
<p>If you want a bigger challenge, and/or more freedom when making your plots, do the following in lieu of step 10 above.</p>
<p>From the graph made for you above, once you’ve zoomed in to an appropriate region and plotted the desired columns, you can download the data currently in that graph window as a table, so that you can make your own more unique and sophistacated graph. You do this by clicking on the right-most icon at the bottom of your graph labeled “Download table of plotted data”, right next to the “Download as PNG” button. Here, I’ve downloaded “MODEL_INIT” plotted against “TIME” for the first 300 or so days, as a file named “KIC_7529266.tbl”</p>
<p>Once this file has been downloaded and moved into my current working folder (i.e. Day 3), I can load it into Python like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>

<span class="n">kepler_435b_tab</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;./static/KIC_7529266.tbl&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.ipac&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we’re going to modify our <code class="docutils literal notranslate"><span class="pre">square_dip</span></code> function so that we can use the provided parameters from the Kepler catalog to model the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">square_dip</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">fluxes</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">star_mass</span><span class="p">,</span> <span class="n">star_radius</span><span class="p">,</span> <span class="n">planet_radius</span><span class="p">,</span> <span class="n">period</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Let&#39;s add some comments to our custom function to make sure we don&#39;t </span>
<span class="sd">    forget what it does.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    times : array</span>
<span class="sd">        The observation times of our exoplanet in days.</span>
<span class="sd">    fluxes : array</span>
<span class="sd">        The flux we anticipate seeing from the star before adding a planet.</span>
<span class="sd">    start_time : float</span>
<span class="sd">        The start time of the first transit, in days.</span>
<span class="sd">    star_mass : float</span>
<span class="sd">        The mass of the parent star, in solar masses.</span>
<span class="sd">    star_radius : float</span>
<span class="sd">        The radius of the parent star, in solar radii.</span>
<span class="sd">    planet_radius : float</span>
<span class="sd">        The radius of our exoplanet, in Jupiter radii.</span>
<span class="sd">    period : float</span>
<span class="sd">        How often the our planet transits in front of the star, in days.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    flux : array</span>
<span class="sd">        The values of the normalized amount of light received from the</span>
<span class="sd">        parent star.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert our times and period from days to seconds</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">times</span> <span class="o">*</span> <span class="mi">86400</span>
    <span class="n">period</span> <span class="o">=</span> <span class="n">period</span> <span class="o">*</span> <span class="mi">86400</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="o">*</span> <span class="mi">86400</span>

    <span class="c1"># Assume we&#39;re orbiting a Sun-like parent star </span>
    <span class="c1"># with an 89 degree incline</span>
    <span class="n">G</span> <span class="o">=</span> <span class="mf">6.67e-11</span>  <span class="c1"># Gravitational constant in the MKS system</span>
    <span class="n">star_mass</span> <span class="o">=</span> <span class="n">star_mass</span> <span class="o">*</span> <span class="mf">1.989e30</span>  <span class="c1"># Convert from solar masses in kilograms</span>
    <span class="n">star_radius</span> <span class="o">=</span> <span class="n">star_radius</span> <span class="o">*</span> <span class="mf">6.957e8</span>  <span class="c1"># Convert from solar radii to meters</span>
    <span class="n">planet_radius</span> <span class="o">=</span> <span class="n">planet_radius</span> <span class="o">*</span> <span class="mf">7.1492000e7</span>  <span class="c1"># Convert from Jupiter radii to meters</span>

    <span class="c1"># We&#39;ll convert the inclination to radians</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mf">85.51</span><span class="p">)</span>

    <span class="c1"># Calculate the semi-major axis of the orbit</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">((</span><span class="n">period</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">G</span> <span class="o">*</span> <span class="n">star_mass</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Semi-major axis:&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">/</span><span class="mf">1.496e11</span><span class="p">,</span> <span class="s2">&quot;AU&quot;</span><span class="p">)</span>

    <span class="c1"># The impact parameter of the orbit</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="n">star_radius</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Impact parameter:&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="c1"># Calculate how long it takes the planet to cross the star</span>
    <span class="n">transit_duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">period</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">star_radius</span> <span class="o">+</span> <span class="n">planet_radius</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">star_radius</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Transit duration: &quot;</span><span class="p">,</span> <span class="n">transit_duration</span><span class="o">/</span><span class="mi">86400</span><span class="p">,</span> <span class="s2">&quot;days&quot;</span><span class="p">)</span>
    
    <span class="c1"># Now calculate the transit depth, i.e. how much light is blocked when it transits</span>
    <span class="n">transit_depth</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">planet_radius</span> <span class="o">/</span> <span class="n">star_radius</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Transit Depth:&quot;</span><span class="p">,</span> <span class="n">transit_depth</span><span class="p">)</span>

    <span class="c1"># Let&#39;s randomly choose a time for our first transit</span>
    <span class="c1"># first_transit = np.random.uniform(0, times[-1] * 0.2)</span>
    
    <span class="n">transit_start</span> <span class="o">=</span> <span class="n">start_time</span>
    <span class="n">transit_end</span> <span class="o">=</span> <span class="n">transit_start</span> <span class="o">+</span> <span class="n">transit_duration</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="c1"># If our time is during a transit, add the transit depth. However, if there</span>
        <span class="c1"># are multiple planets, only take the deepest transit depth.</span>
        <span class="k">if</span> <span class="n">transit_start</span> <span class="o">&lt;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">transit_end</span><span class="p">:</span>
            <span class="n">fluxes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">transit_depth</span><span class="p">,</span> <span class="n">fluxes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="c1"># If we&#39;ve just exited the tranit, reset the</span>
        <span class="c1"># our variables for the next transit</span>
        <span class="k">elif</span> <span class="n">t</span> <span class="o">&gt;=</span> <span class="n">transit_end</span><span class="p">:</span>
            <span class="n">transit_start</span> <span class="o">+=</span> <span class="n">period</span>
            <span class="n">transit_end</span> <span class="o">=</span> <span class="n">transit_start</span> <span class="o">+</span> <span class="n">transit_duration</span>

    <span class="k">return</span> <span class="n">fluxes</span>
</pre></div>
</div>
</div>
</div>
<p>Refer back to the catalog on the website. For our chosen exoplanet, we find that <span class="math notranslate nohighlight">\(t_\mathrm{start} = 134.4 \; \mathrm{days}\)</span>, <span class="math notranslate nohighlight">\(M_s = 1.538 \; \mathrm{M_\odot}\)</span>, <span class="math notranslate nohighlight">\(R_s = 3.21 \; \mathrm{R_\odot}\)</span>, <span class="math notranslate nohighlight">\(R_p = 1.99 \; \mathrm{R_Jup}\)</span>, and <span class="math notranslate nohighlight">\(P = 8.6 \; \mathrm{days}\)</span>, so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Get the observed data from the table. Note that we add 1 to the flux decrement.</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">kepler_435b_tab</span><span class="p">[</span><span class="s1">&#39;TIME&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">kepler_435b_tab</span><span class="p">[</span><span class="s1">&#39;LC_DETREND&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">fluxes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">))</span>

<span class="c1"># Now plot it!</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">square_dip</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">fluxes</span><span class="p">,</span> <span class="n">start_time</span><span class="o">=</span><span class="mf">134.448</span><span class="p">,</span> <span class="n">star_mass</span><span class="o">=</span><span class="mf">1.538</span><span class="p">,</span> <span class="n">star_radius</span><span class="o">=</span><span class="mf">3.21</span><span class="p">,</span> <span class="n">planet_radius</span><span class="o">=</span><span class="mf">1.99</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mf">8.6001536</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">132</span><span class="p">,</span> <span class="mi">137</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time [days]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Normalized Flux&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Semi-major axis: 0.09481290326450129 AU
Impact parameter: 0.4972228879872089
Transit duration:  0.4067889013456635 days
Transit Depth: 0.9959414866891165
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Normalized Flux&#39;)
</pre></div>
</div>
<img alt="../_images/analyzing-kepler-lightcurves_5_2.png" src="../_images/analyzing-kepler-lightcurves_5_2.png" />
</div>
</div>
<p>Not bad for our simple model!</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./day_three"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../day_two/defining-a-model.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Defining a Model</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../day_four/radial-velocities-and-atmospheres.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Radial Velocities and Atmospheres</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Nicholas Earl based on material from Taylor Hutchison and Ryan Blackman<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>